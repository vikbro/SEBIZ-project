<!DOCTYPE html>
<html>
<head>
    <title>Play Game</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden;
            height: 100%;
            width: 100%;
        }
        iframe {
            border: none;
            height: 100%;
            width: 100%;
        }
    </style>
</head>
<body>
    <iframe id="game-iframe"></iframe>

    <script>
        const gameId = window.location.pathname.split('/').pop();
        const iframe = document.getElementById('game-iframe');
        iframe.src = `/api/Play/Content/${gameId}/`;

        let startTime = Date.now();

        function sendPlaytime() {
            const secondsPlayed = Math.round((Date.now() - startTime) / 1000);
            if (secondsPlayed > 0) {
                const data = { gameId, secondsPlayed };
                const blob = new Blob([JSON.stringify(data)], { type: 'application/json' });
                navigator.sendBeacon('/api/Play/playtime/update', blob);
            }
        }

        window.addEventListener('beforeunload', sendPlaytime);
    </script>
</body>
</html>
